<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
   
<h:head>
    <title>Welcome</title>
</h:head>
<h:body>
    <h:form id="selectLanguage">
        <p:panelGrid columns="2">
            <h:outputText value="Lang" />
            <p:selectOneMenu value="#{languageSwitcherBean.selectedLanguage}" onchange="document.getElementById('selectLanguage').submit();" >
                <f:selectItems value="#{languageSwitcherBean.languages}" ></f:selectItems>
            </p:selectOneMenu> 
        </p:panelGrid>
    </h:form>

    <p:dialog header="Create New Anagraphic" widgetVar="newAnagraphicDialog" resizable="false" id="newAnagraphicDlg" > 
        <h:form id="anagraphicForm">
            <p:panelGrid id="displayNewAnagraphic" columns="2" style="margin:0 auto;">
                <h:outputText  value="#{message.i18n('anagraphic.firstName.label')}"/>
                <p:inputText id="firstName" value="#{anagraphicMB.anagraphic.firstName}" autocomplete="off" />

                <h:outputText value="#{message.i18n('anagraphic.surname.label')}"/>
                <p:inputText id="surname" value="#{anagraphicMB.anagraphic.surname}" autocomplete="off" />

                <f:facet name="footer">
                    <p:commandButton id="add" value="#{message.i18n('default.add.button')}" action="#{anagraphicMB.add}" ajax="false"/>
                    <p:commandButton id="reset" value="#{message.i18n('default.reset.button')}" action="#{anagraphicMB.reset}" ajax="false"/>
                </f:facet>
            </p:panelGrid>
        </h:form>
    </p:dialog>
    <h:form id="anagraphicsForm">
        <p:growl id="messages" showDetail="true"/>

        <p:dataTable id="anagraphicsDT" var="anagraphic" value="#{anagraphicMB.anagraphics}" selection="#{anagraphicMB.selectedAnagraphics}" rowKey="#{anagraphic.id}"
                    rows="10" paginator="true" rowsPerPageTemplate="10,20,50" lazy="true"
                    paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

            <p:column selectionMode="multiple" width="5%" style="text-align: center;" />
            
            <p:column headerText="ID" width="5%" style="text-align: center;">
                <h:outputText value="#{anagraphic.id}"/>
            </p:column>
            <p:column headerText="${message.i18n('anagraphic.firstName.label')}" sortBy="#{anagraphic.firstName}" filterBy="#{anagraphic.firstName}">
                <h:outputText value="#{anagraphic.firstName}"/>
            </p:column>
            <p:column headerText="${message.i18n('anagraphic.surname.label')}" sortBy="#{anagraphic.surname}" filterBy="#{anagraphic.surname}">
                <h:outputText value="#{anagraphic.surname}"/>
            </p:column>
            <f:facet name="footer">
                <p:commandButton value="New Anagraphic" oncomplete="PF('newAnagraphicDialog').show()" icon="ui-icon-star" title="Creates new Anagraphic"/>
                <p:commandButton process="anagraphicsDT" update=":anagraphicsForm:anagraphicDetail" icon="ui-icon-search" value="View" oncomplete="PF('anagraphicDialog').show()" />
            </f:facet>
        </p:dataTable>
        <br/>
        <p:dialog header="Selected Anagraphics" widgetVar="anagraphicDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" width="200">
            <p:outputPanel id="anagraphicDetail" style="text-align:center;">
                <ui:repeat value="#{anagraphicMB.selectedAnagraphics}" var="anagraphic">
                    <h:outputText value="#{anagraphic.id} - #{anagraphic.firstName} #{anagraphic.surname}" style="display:block"/>
                </ui:repeat>
            </p:outputPanel>
        </p:dialog>
    </h:form>
</h:body>
</html>